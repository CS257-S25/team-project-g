<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Authors</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='global.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='nav.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='authors.css') }}">
</head>
<body>
  {% include 'nav.html' %}
  <h3>Authors</h3>

  <ul>
    {# 1. Build a deduplicated list of all authors (as before) #}
    {% set all_authors = [] %}
    {% for book in books %}
      {% for author in book.authors %}
        {% if author not in all_authors %}
          {% set _ = all_authors.append(author) %}
        {% endif %}
      {% endfor %}
    {% endfor %}

    {# 2. Sort them once, and track “previous initial” #}
    {% set sorted_authors = all_authors | sort %}
    {% set prev_initial = None %}

    {% for author in sorted_authors %}
      {# Determine the uppercase first letter of the current author #}
      {% set initial = author[0] | upper %}

      {# If this initial is different from the one before, emit a “boxed” header #}
      {% if initial != prev_initial %}
        <li class="initial-box">{{ initial }}</li>
        {% set prev_initial = initial %}
      {% endif %}

      {# Now emit the actual author link #}
      <li class="author-item">
        <a href="/author/{{ author }}">{{ author }}</a>
      </li>
    {% endfor %}
  </ul>
</body>
</html>
